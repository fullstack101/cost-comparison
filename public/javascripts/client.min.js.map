{"version":3,"file":"client.min.js","sources":["client.js"],"sourcesContent":["const httpJSONRequest = function (url) {\r\n    return new Promise(function (resolve, reject) {\r\n        let xhr = new XMLHttpRequest();\r\n\r\n        xhr.withCredentials = false;\r\n        xhr.open('GET', url, true);\r\n        xhr.send();\r\n        xhr.addEventListener(\"readystatechange\", processRequest, false);\r\n\r\n        function processRequest(e) {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let response = JSON.parse(xhr.responseText);\r\n                resolve(response);\r\n            } else if (xhr.readyState == 4) {\r\n                console.log(xhr.readyState);\r\n                console.log(xhr.status);\r\n                reject(Error(\"Something went wrong with the request \\n\\t\\t\\t\\t\\t XHR Status: \" + xhr.status));\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nhttpJSONRequest(\"/testIP\")\r\n    .then((json) => console.log(json));\r\n\r\nhttpJSONRequest(\"/numbeo\")\r\n    .then(function (json) {\r\n        drawLeftChart(json[0], \"col1\", \".chart1\");\r\n        drawRightChart(json[1], \"col2\", \".chart2\");\r\n    });\r\n\r\nfunction drawLeftChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n\r\n    d3.select(\"#col1\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = 600 - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n\r\n    let xAxis = chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisTop(x).ticks(10, \"$\"));\r\n    xAxis.selectAll(\"text\")\r\n        .attr(\"transform\", \"matrix(-1 0 0 1 0 0)\");\r\n    xAxis.attr(\"transform\", \"translate(600, 0) matrix(-1 0 0 1 0 0)\")\r\n\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"transform\", function (d) {\r\n            return \"translate(\" + (margin.left + margin.right + width - x(d.average_price)) + \",0)\"\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", function (d) {\r\n            return margin.left + margin.right + width-10;\r\n        })\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .text(function (d) {\r\n            let itemName =d.item_name.substring(0, d.item_name.indexOf(\",\"));\r\n            itemName= d.average_price.toFixed(2)+ \", \" + itemName;\r\n            return itemName;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n\r\nfunction drawRightChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n\r\n    d3.select(\"#col2\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = 600 - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let xText = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, (obj) => obj.item_name.substring(0, obj.item_name.indexOf(\",\")).length+6)])\r\n        .range([0, width]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n    chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisTop(x).ticks(10, \"$\"))\r\n        .attr(\"transform\", \"translate(\" + 0 + \", 0)\")\r\n        .append(\"text\")\r\n        .attr(\"x\", 6)\r\n        .attr(\"dx\", \"0.71em\")\r\n        .attr(\"text-anchor\", \"end\")\r\n        .text(\"Price\")\r\n        .attr(\"transform\", \"translate(\" + 20 + \", -9)\");\r\n\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", 10)\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(function (d) {\r\n            let itemName =d.item_name.substring(0, d.item_name.indexOf(\",\"));\r\n            itemName+=\", \" + d.average_price.toFixed(2);\r\n            return itemName;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n// Pretty JSON\r\n\r\nfunction syntaxHighlight(json) {\r\n    if (typeof json != 'string') {\r\n        json = JSON.stringify(json, undefined, 2);\r\n    }\r\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\r\n        let cls = 'number';\r\n        if (/^\"/.test(match)) {\r\n            if (/:$/.test(match)) {\r\n                cls = 'key';\r\n            } else {\r\n                cls = 'string';\r\n            }\r\n        } else if (/true|false/.test(match)) {\r\n            cls = 'boolean';\r\n        } else if (/null/.test(match)) {\r\n            cls = 'null';\r\n        }\r\n        return '<span class=\"' + cls + '\">' + match + '</span>';\r\n    });\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":["httpJSONRequest","url","Promise","resolve","reject","xhr","XMLHttpRequest","withCredentials","open","send","addEventListener","processRequest","e","readyState","status","response","JSON","parse","responseText","log","Error","then","json","console","drawLeftChart","cityJSON","col","chartClass","cityStats","prices","select","text","name","barHeight","margin","top","right","bottom","left","width","height","x","d3","scaleLinear","domain","max","obj","average_price","range","chart","attr","length","append","bar","selectAll","data","enter","d","i","xAxis","call","axisTop","ticks","itemName","item_name","substring","indexOf","toFixed","drawRightChart","xText","style"],"mappings":"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"}