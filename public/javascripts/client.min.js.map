{"version":3,"file":"client.min.js","sources":["client.js"],"sourcesContent":["const httpJSONRequest = function (url) {\r\n    return new Promise(function (resolve, reject) {\r\n        let xhr = new XMLHttpRequest();\r\n\r\n        xhr.withCredentials = false;\r\n        xhr.open('GET', url, true);\r\n        xhr.send();\r\n        xhr.addEventListener(\"readystatechange\", processRequest, false);\r\n\r\n        function processRequest(e) {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let response = JSON.parse(xhr.responseText);\r\n                resolve(response);\r\n            } else if (xhr.readyState == 4) {\r\n                reject(Error(\"Something went wrong with the request \\n\\t\\t\\t\\t\\t XHR Status: \" + xhr.status));\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nhttpJSONRequest(\"/testIP\")\r\n    .then((json) => console.log(json));\r\n\r\nhttpJSONRequest(\"/numbeo\")\r\n    .then(function (json) {\r\n        drawLeftChart(json[0], \"#col1\", \".chart1\");\r\n        drawRightChart(json[1], \"#col2\", \".chart2\");\r\n        d3.select(\"body\").on(\"click\", function() {\r\n            if(d3.select(\"#col1\").style(\"background-color\")==\"rgb(0, 128, 0)\"){\r\n                d3.select(\"#col1\").style(\"background-color\", \"white\");\r\n                d3.select(\"#col2\").style(\"background-color\", \"white\");\r\n                d3.select(\"#col1 div\").style(\"color\", \"black\");\r\n                d3.select(\"#col2 div\").style(\"color\", \"black\");\r\n                d3.selectAll(\"text\").style(\"fill\", \"black\");\r\n            } else {\r\n                d3.select(\"#col1\").style(\"background-color\", \"green\");\r\n                d3.select(\"#col2\").style(\"background-color\", \"green\");\r\n                d3.select(\"#col1 div\").style(\"color\", \"white\");\r\n                d3.select(\"#col2 div\").style(\"color\", \"white\");\r\n                d3.selectAll(\"text\").style(\"fill\", \"white\");\r\n            }\r\n        });\r\n    });\r\n\r\n//TODO: Move chart drawing to a separate module\r\n\r\nfunction drawLeftChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n\r\n    d3.select(\"#col1\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = parseInt(d3.select(\"#col1\").style(\"width\"), 10) - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right - 1)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n\r\n    let xAxis = chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisTop(x).ticks(10, \"$\"));\r\n    xAxis.selectAll(\"text\")\r\n        .attr(\"transform\", \"matrix(-1 0 0 1 0 0)\")\r\n        .style(\"text-anchor\", \"middle\");\r\n    xAxis.attr(\"transform\", \"translate(\"+ (width + margin.left + margin.right - 1) + \", 0) matrix(-1 0 0 1 0 0)\")\r\n\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"transform\", function (d) {\r\n            return \"translate(\" + (margin.left + margin.right + width - x(d.average_price)) + \",0)\"\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", function (d) {\r\n            return margin.left + margin.right + width-10;\r\n        })\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .text(function (d) {\r\n            let itemName =d.item_name.substring(0, d.item_name.indexOf(\",\"));\r\n            itemName= \"$\"+d.average_price.toFixed(2)+ \", \" + itemName;\r\n            return itemName;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n\r\nfunction drawRightChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n\r\n    d3.select(\"#col2\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = parseInt(d3.select(\"#col2\").style(\"width\"), 10) - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let xText = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, (obj) => obj.item_name.substring(0, obj.item_name.indexOf(\",\")).length+6)])\r\n        .range([0, width]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right - 1)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n    let xAxis = chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisTop(x).ticks(10, \"$\"))\r\n        .attr(\"transform\", \"translate(\" + 0 + \", 0)\");\r\n    xAxis.selectAll(\"text\").style(\"text-anchor\", \"middle\");\r\n    xAxis.selectAll(\"text\").append(\"text\")\r\n        .attr(\"x\", 6)\r\n        .attr(\"dx\", \"0.71em\")\r\n        .attr(\"text-anchor\", \"end\")\r\n        .text(\"Price\")\r\n        .attr(\"transform\", \"translate(\" + 20 + \", -9)\");\r\n\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", 10)\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(function (d) {\r\n            let itemName =d.item_name.substring(0, d.item_name.indexOf(\",\"));\r\n            itemName+=\", \" + \"$\" +d.average_price.toFixed(2);\r\n            return itemName;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n// Pretty JSON\r\n\r\nfunction syntaxHighlight(json) {\r\n    if (typeof json != 'string') {\r\n        json = JSON.stringify(json, undefined, 2);\r\n    }\r\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\r\n        let cls = 'number';\r\n        if (/^\"/.test(match)) {\r\n            if (/:$/.test(match)) {\r\n                cls = 'key';\r\n            } else {\r\n                cls = 'string';\r\n            }\r\n        } else if (/true|false/.test(match)) {\r\n            cls = 'boolean';\r\n        } else if (/null/.test(match)) {\r\n            cls = 'null';\r\n        }\r\n        return '<span class=\"' + cls + '\">' + match + '</span>';\r\n    });\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":["httpJSONRequest","url","Promise","resolve","reject","xhr","XMLHttpRequest","withCredentials","open","send","addEventListener","processRequest","e","readyState","status","response","JSON","parse","responseText","Error","then","json","console","log","select","on","d3","style","selectAll","drawLeftChart","cityJSON","col","chartClass","cityStats","prices","text","name","barHeight","margin","top","right","bottom","left","width","parseInt","height","x","scaleLinear","domain","max","obj","average_price","range","chart","attr","length","append","bar","data","enter","d","i","xAxis","call","axisTop","ticks","itemName","item_name","substring","indexOf","toFixed","drawRightChart","xText"],"mappings":"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"}