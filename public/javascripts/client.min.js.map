{"version":3,"file":"client.min.js","sources":["client.js"],"sourcesContent":["const httpJSONRequest = function (url) {\r\n    return new Promise(function (resolve, reject) {\r\n        console.log(url);\r\n        let xhr = new XMLHttpRequest();\r\n\r\n        xhr.withCredentials = false;\r\n        xhr.open('GET', url, true);\r\n        xhr.send();\r\n        xhr.addEventListener(\"readystatechange\", processRequest, false);\r\n\r\n        function processRequest(e) {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let response = JSON.parse(xhr.responseText);\r\n                resolve(response);\r\n            } else if (xhr.readyState == 4) {\r\n                console.log(xhr.readyState);\r\n                console.log(xhr.status);\r\n                reject(Error(\"Something went wrong with the request \\n\\t\\t\\t\\t\\t XHR Status: \" + xhr.status));\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nhttpJSONRequest(\"/testIP\")\r\n    .then((json) => console.log(json));\r\n\r\nhttpJSONRequest(\"/numbeo\")\r\n    .then(function (json) {\r\n        drawLeftChart(json[0], \"col1\", \".chart1\");\r\n        drawRightChart(json[1], \"col2\", \".chart2\");\r\n    });\r\n\r\nfunction drawLeftChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n    //json[0];\r\n    console.log(\"Before filter: \" + cityStats.length);\r\n    cityStats = cityStats.filter(obj => obj.average_price < 10);\r\n    console.log(\"After filter: \" + cityStats.length);\r\n\r\n    d3.select(\"#col1\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = 600 - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n    console.log(width);\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let xText = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => (margin.left + margin.right + width-obj.item_name.length))])\r\n        .range([0, (margin.left + margin.right + width)]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        //.attr(\"transform\", \"rotate(180)\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n    //.attr(\"transform\", \"translate(\" + width + \",\" + margin.top + \") rotate(-180 0 \"+ width + \")\");\r\n\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n\r\n    chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisBottom(x).ticks(10, \"$\"))\r\n        .attr(\"transform\", \"rotate(180 \" + ((+margin.left + margin.right + width) / 2) + \" \" + 0 + \")\")\r\n        .append(\"text\")\r\n        .attr(\"x\", 6)\r\n        .attr(\"dx\", \"0.71em\")\r\n        .attr(\"text-anchor\", \"end\")\r\n        .text(\"Price\")\r\n        //.attr(\"transform\", \"translate(\" + 20 + \", -9)\");\r\n        .attr(\"transform\", \"translate(\" + (20-width) + \", 9) rotate(-180 \" + ((width) / 2) + \" \" + 0 + \")\");\r\n\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"transform\", function (d) {\r\n            return \"translate(\" + (margin.left + margin.right + width - x(d.average_price)) + \",0)\"\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", function (d) {\r\n            return ( xText(margin.left + margin.right + width-d.item_name.length));\r\n        })\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .text(function (d) {\r\n            return d.item_name;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n\r\nfunction drawRightChart(cityJSON, col, chartClass) {\r\n    let cityStats = cityJSON.prices;\r\n    console.log(\"Before filter: \" + cityStats.length);\r\n    cityStats = cityStats.filter(obj => obj.average_price < 10);\r\n    console.log(\"After filter: \" + cityStats.length);\r\n\r\n    d3.select(\"#col2\").select(\"div.city-name\").text(cityJSON.name);\r\n    let barHeight = 29;\r\n    let margin = {top: 20, right: 30, bottom: 30, left: 40},\r\n        width = 600 - margin.left - margin.right,\r\n        height = 500 - margin.top - margin.bottom;\r\n\r\n    let x = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.average_price)])\r\n        .range([0, width]);\r\n\r\n    let xText = d3.scaleLinear()\r\n        .domain([0, d3.max(cityStats, obj => obj.item_name.length)])\r\n        .range([0, width]);\r\n\r\n    let chart = d3.select(chartClass)\r\n        .attr(\"width\", width + margin.left + margin.right)\r\n        .attr(\"height\", ((barHeight + 1) * cityStats.length) + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\");\r\n\r\n    let bar = chart.selectAll(\"g\")\r\n        .data(cityStats)\r\n        .enter().append(\"g\")\r\n        .attr(\"transform\", function (d, i) {\r\n            return \"translate(0,\" + (i * (barHeight + 1) + 3) + \")\";\r\n        });\r\n    chart.append(\"g\")\r\n        .attr(\"class\", \"axis axis--x\")\r\n        .call(d3.axisTop(x).ticks(10, \"$\"))\r\n        .attr(\"transform\", \"translate(\" + 0 + \", 0)\")\r\n        .append(\"text\")\r\n        .attr(\"x\", 6)\r\n        .attr(\"dx\", \"0.71em\")\r\n        .attr(\"text-anchor\", \"end\")\r\n        .text(\"Price\")\r\n        .attr(\"transform\", \"translate(\" + 20 + \", -9)\");\r\n    bar.append(\"rect\")\r\n        .attr(\"width\", function (d) {\r\n            return x(d.average_price);\r\n        })\r\n        .attr(\"height\", barHeight)\r\n        .attr(\"class\", \"bar\");\r\n\r\n    bar.append(\"text\")\r\n        .attr(\"x\", function (d) {\r\n            return xText(d.item_name.length);\r\n        })\r\n        .attr(\"y\", barHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .text(function (d) {\r\n            return d.item_name;\r\n        });\r\n    //document.getElementById(col).appendChild(document.createElement('pre')).innerHTML = syntaxHighlight(cityJSON);\r\n}\r\n// Pretty JSON\r\n\r\nfunction syntaxHighlight(json) {\r\n    if (typeof json != 'string') {\r\n        json = JSON.stringify(json, undefined, 2);\r\n    }\r\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\r\n        let cls = 'number';\r\n        if (/^\"/.test(match)) {\r\n            if (/:$/.test(match)) {\r\n                cls = 'key';\r\n            } else {\r\n                cls = 'string';\r\n            }\r\n        } else if (/true|false/.test(match)) {\r\n            cls = 'boolean';\r\n        } else if (/null/.test(match)) {\r\n            cls = 'null';\r\n        }\r\n        return '<span class=\"' + cls + '\">' + match + '</span>';\r\n    });\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":["httpJSONRequest","url","Promise","resolve","reject","log","xhr","XMLHttpRequest","withCredentials","open","send","addEventListener","processRequest","e","readyState","status","response","JSON","parse","responseText","Error","then","json","console","drawLeftChart","cityJSON","col","chartClass","cityStats","prices","length","filter","obj","average_price","select","text","name","barHeight","margin","top","right","bottom","left","width","height","x","d3","scaleLinear","domain","max","range","xText","item_name","chart","attr","append","bar","selectAll","data","enter","d","i","call","axisBottom","ticks","drawRightChart","axisTop"],"mappings":"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"}